<p-toast></p-toast>
<p-confirmDialog></p-confirmDialog>

<div class="card">
  <div class="flex justify-content-between align-items-center mb-4">
    <h2 class="m-0 text-primary">Gestão de Bairros</h2>
    <button pButton label="Novo Bairro" icon="pi pi-plus" class="p-button-raised p-button-success" (click)="novo()"></button>
  </div>

  <p-table [value]="bairros" [paginator]="true" [rows]="10" [loading]="carregando" responsiveLayout="scroll" styleClass="p-datatable-striped">
    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="id" style="width: 100px;">ID <p-sortIcon field="id"></p-sortIcon></th>
        <th pSortableColumn="nome">Nome <p-sortIcon field="nome"></p-sortIcon></th>
        <th style="width: 150px;" class="text-center">Ações</th>
      </tr>
    </ng-template>
    
    <ng-template pTemplate="body" let-bairro>
      <tr>
        <td class="text-500">{{ bairro.id }}</td>
        <td class="font-bold">
          {{ bairro.nome }}
          <i *ngIf="bairro.emUso" class="pi pi-lock text-500 ml-2" 
             pTooltip="Este bairro possui registros vinculados (ruas ou pontos de coleta)" tooltipPosition="right"></i>
        </td>
        <td class="text-center">
          
          <button pButton icon="pi pi-pencil" class="p-button-rounded p-button-secondary p-button-text" 
                  [disabled]="bairro.emUso"
                  [pTooltip]="bairro.emUso ? 'Não é possível editar: Bairro em uso' : 'Editar'" 
                  tooltipPosition="top" 
                  (click)="editar(bairro)">
          </button>

          <button pButton icon="pi pi-trash" class="p-button-rounded p-button-danger p-button-text" 
                  [disabled]="bairro.emUso"
                  [pTooltip]="bairro.emUso ? 'Não é possível excluir: Bairro em uso' : 'Excluir'"
                  tooltipPosition="top" 
                  (click)="confirmarExclusao(bairro)">
          </button>

        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="3" class="text-center p-4">
          <span class="text-500">Nenhum bairro cadastrado. Clique em "Novo Bairro".</span>
        </td>
      </tr>
    </ng-template>
  </p-table>

  <div class="text-sm text-500 mt-2">
    Total de registros: {{ bairros.length }}
  </div>
</div>